import * as ledger from '@midnight-ntwrk/ledger-v7';
import { Schema, Scope, Stream } from 'effect';
import { CoreWallet } from './CoreWallet.js';
import { Simulator, SimulatorState } from './Simulator.js';
import { WalletError } from './WalletError.js';
import { TransactionHistoryCapability } from './TransactionHistory.js';
export interface SyncService<TState, TStartAux, TUpdate> {
    updates: (state: TState, auxData: TStartAux) => Stream.Stream<TUpdate, WalletError, Scope.Scope>;
}
export interface SyncCapability<TState, TUpdate> {
    applyUpdate: (state: TState, update: TUpdate) => TState;
}
export type IndexerClientConnection = {
    indexerHttpUrl: string;
    indexerWsUrl?: string;
};
export type DefaultSyncConfiguration = {
    indexerClientConnection: IndexerClientConnection;
    batchSize?: number;
};
export type DefaultSyncContext = {
    transactionHistoryCapability: TransactionHistoryCapability<CoreWallet, ledger.FinalizedTransaction>;
};
type SecretKeysResource = <A>(cb: (keys: ledger.ZswapSecretKeys) => A) => A;
export declare const SecretKeysResource: {
    create: (secretKeys: ledger.ZswapSecretKeys) => SecretKeysResource;
};
export type WalletSyncUpdate = {
    updates: EventsSyncUpdate[];
    secretKeys: SecretKeysResource;
};
export declare const WalletSyncUpdate: {
    create: (updates: EventsSyncUpdate[], secretKeys: ledger.ZswapSecretKeys) => WalletSyncUpdate;
};
export declare const EventsSyncUpdate: Schema.TaggedStruct<"EventsSyncUpdate", {
    id: typeof Schema.Number;
    maxId: typeof Schema.Number;
    event: Schema.declare<ledger.Event, ledger.Event, readonly [], never>;
}>;
export type EventsSyncUpdate = Schema.Schema.Type<typeof EventsSyncUpdate>;
export declare const makeEventsSyncService: (config: DefaultSyncConfiguration) => SyncService<CoreWallet, ledger.ZswapSecretKeys, WalletSyncUpdate>;
export declare const makeEventsSyncCapability: () => SyncCapability<CoreWallet, WalletSyncUpdate>;
export type SimulatorSyncConfiguration = {
    simulator: Simulator;
};
export type SimulatorSyncUpdate = {
    update: SimulatorState;
    secretKeys: ledger.ZswapSecretKeys;
};
export declare const makeSimulatorSyncService: (config: SimulatorSyncConfiguration) => SyncService<CoreWallet, ledger.ZswapSecretKeys, SimulatorSyncUpdate>;
export declare const makeSimulatorSyncCapability: () => SyncCapability<CoreWallet, SimulatorSyncUpdate>;
export {};
